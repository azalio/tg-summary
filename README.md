# Суммаризация чатов из под личного аккаунта Telegram

## Цели проекта

- Автоматически собирать сообщения из выбранных Telegram чатов под личным аккаунтом.
- Раз в сутки формировать дайджест (суммаризацию) сообщений с помощью нейросети (LLM).
- Присылать дайджест пользователю удобным способом (например, в личные сообщения или email).
- Проект написан на Go и демонстрирует лучшие production-практики senior-уровня.
- Проект будет запускаться в kubernetes

## Архитектура

1. **Интеграция с Telegram**
   - Используется production Go-клиент [gotd/td](https://github.com/gotd/td) (асинхронный, официальный, поддерживает все типы чатов).
   - Авторизация через личный аккаунт (userbot, сессия хранится локально).
   - Сбор сообщений и метаданных из выбранных чатов, групп и супергрупп.

2. **Хранение сообщений**
   - Локальная база данных (например, SQLite).
   - Структурированное хранение сообщений для последующей обработки.

3. **Суммаризация (LLM)**
   - Использование внешнего API (например, OpenAI, YandexGPT) или локальной модели.
   - Формирование краткого дайджеста по каждому чату.

4. **Планировщик**
   - Ежедневный запуск задачи суммаризации (например, через встроенный cron/scheduler).

5. **Доставка дайджеста**
   - Отправка дайджеста в Telegram, email или другой канал.

## Технологии и библиотеки

- Go 1.21+
- GoTD ([gotd/td](https://github.com/gotd/td)) — асинхронный Go-клиент Telegram API
- SQLite (через [mattn/go-sqlite3](https://github.com/mattn/go-sqlite3))
- HTTP-клиент для работы с LLM API
- Планировщик задач ([robfig/cron](https://github.com/robfig/cron))
- Логирование ([uber-go/zap](https://github.com/uber-go/zap))
- Конфигурирование ([spf13/viper](https://github.com/spf13/viper))
- Тестирование (Go test, mocks)

## Production-практики

- Чистая архитектура, разделение слоев (интеграция, бизнес-логика, хранилище, delivery)
- Конфигурирование через файлы/переменные окружения
- Строгая обработка ошибок
- Логирование и трассировка
- Написание кода для упрощения юнит-тестирования
- Покрытие тестами ключевых компонентов
- Документирование кода и архитектуры

## Структура проекта (план)

```
tg-summary/
  cmd/                # Точка входа (main.go)
  internal/
    telegram/         # Работа с Telegram
    storage/          # Работа с БД
    summarizer/       # LLM-интеграция
    scheduler/        # Планировщик
    delivery/         # Отправка дайджеста
    config/           # Конфигурирование
  scripts/            # Скрипты для запуска tg-cli и т.д.
  test/               # Тесты
  README.md
```

## Быстрый старт (будет дополняться)

1. Установить Go, необходимые зависимости (`go mod tidy`).
2. Получить Telegram API ID и API Hash на https://my.telegram.org.
3. Заполнить .env или переменные окружения: TELEGRAM_APP_ID, TELEGRAM_APP_HASH, TELEGRAM_PHONE, TELEGRAM_SESSION_DIR.
4. Запустить сервис: `go run ./cmd`
5. При первом запуске ввести код авторизации из Telegram.
6. Проверить, что список групп выводится в логах, сообщения собираются и дайджест формируется.

## TODO

- [ ] Scaffold проекта и базовые интерфейсы
- [ ] Интеграция с Telegram
- [ ] Хранение сообщений
- [ ] Интеграция с LLM
- [ ] Планировщик и отправка дайджеста
- [ ] Тесты и документация

---
Проект развивается как обучающий: все решения сопровождаются комментариями и best practices.
